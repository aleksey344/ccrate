/**
 * Cryptocurrency Charts
 * ---------------------------------------------
 * Version 1.0.2, built on Wednesday, January 10, 2018
 * Copyright (c) Financial Apps and Plugins <info@financialplugins.com>. All rights reserved.
 * Demo: https://financialplugins.com/products/cryptocurrency-charts
 * Purchase: https://codecanyon.net/item/cryptocurrency-charts-js-php/21067221?ref=financialtechnology
 * Like: https://www.facebook.com/financialplugins/
 */
var cccPathToAssets=cccPathToAssets||"",cccGlobals={debug:!1,code:"ccc",pluginUrl:cccPathToAssets+"/cc-charts/",ajaxUrl:cccPathToAssets+"/cc-charts/ajax.php",ajaxGetData:"ajaxGetData",ajaxSymbolAutocomplete:"ajaxSymbolAutocomplete"},cryptocurrencyChartsPlugin=function(e,o){function a(a,i,n,s,c){function d(e,o){return o+" "+n}function p(o){if(r("addComparison",o),"undefined"!=typeof m)if(h(),e.inArray(o,f)==-1)e.ajax({url:cccGlobals.ajaxUrl,method:"post",dataType:"json",data:{action:cccGlobals.ajaxGetData,asset:o,currency:n}}).done(function(e){if(r("response",e),e.success){f.push(o);var a={title:e.symbol,assetId:o,compared:!0,fieldMappings:[{fromField:"value",toField:"value"},{fromField:"volume",toField:"volume"}],dataProvider:e.data,categoryField:"time"};m.dataSets.push(a),m.comparedDataSets.push(a),m.validateData(),g()}else setTimeout(function(){g()},3e3)});else{for(var a=0;a<m.dataSets.length;a++)m.dataSets[a].assetId==o&&(m.dataSets[a].compared=!0);m.validateData(),g()}}function u(e){r("deleteComparison",e);for(var o=0;o<m.dataSets.length;o++)m.dataSets[o].assetId==e&&(m.dataSets[o].compared=!1);m.validateData()}function h(){}function g(){}var m,f=[],b=[],y=e("#"+a);s=s||{},r("chartSettings",i,n,s,c),y.css({width:s.width||"100%",height:s.height||"500px",fontSize:s.fontSize||14,color:s.color||"#383838",background:s.backgroundColor||"#fff"}),y.prepend('<div class="'+l+'-chart-comparison"> <select class="'+t+'" multiple="multiple"></select></div><div id="'+a+'-chart" class="'+l+'-chart"></div>');var v=y.find("."+t);v.cryptocurrencyChartsPlugin().initAssetAutocomplete();var C={type:"stock",mouseWheelScrollEnabled:s.mouseWheelZoomEnabled||!1,categoryAxesSettings:{minPeriod:"DD",color:s.color||"#383838",gridColor:s.gridColor||"#e0e0e0",gridAlpha:s.gridAlpha||.8,gridThickness:"undefined"!=typeof s.gridThickness?s.gridThickness:1,equalSpacing:!0,minHorizontalGap:100,autoGridCount:!0,dateFormats:[{period:"fff",format:"JJ:NN:SS"},{period:"ss",format:"JJ:NN:SS"},{period:"mm",format:"JJ:NN"},{period:"hh",format:"JJ:NN"},{period:"DD",format:"DD MMM"},{period:"WW",format:"DD MMM"},{period:"MM",format:"MMM YY"},{period:"YYYY",format:"YYYY"}]},dataSets:[{fieldMappings:[{fromField:"value",toField:"value"},{fromField:"volume",toField:"volume"}],categoryField:"time"}],panelsSettings:{usePrefixes:s.usePrefixes||!1,fontSize:s.fontSize||14,marginTop:s.marginTop||0,marginRight:s.marginRight||10,marginBottom:s.marginBottom||0,marginLeft:s.marginLeft||10,backgroundColor:s.backgroundColor,backgroundAlpha:0,startDuration:0,thousandsSeparator:s.thousandsSeparator||",",decimalSeparator:s.decimalSeparator||".",precision:s.precision||2,percentPrecision:s.precision||2,creditsPosition:"bottom-left"},panels:[{showCategoryAxis:!0,title:s.primaryPanelTitle||"Price",percentHeight:70,drawingIconsEnabled:!0,eraseAll:!0,stockGraphs:[{id:"mainGraph",type:s.primaryChartType||"smoothedLine",valueField:"value",lineColor:s.primaryLineColor||"#00842c",fillAlphas:s.primaryLineColorAlpha||.15,lineThickness:"undefined"!=typeof s.primaryLineThickness?s.primaryLineThickness:2,comparable:!0,balloonText:"[[title]]: <b>[[value]] "+n+"</b>",compareGraph:{type:s.primaryChartType||"smoothedLine",fillAlphas:s.primaryLineColorAlpha||.15,lineThickness:"undefined"!=typeof s.primaryLineThickness?s.primaryLineThickness:2,balloonText:"[[title]]: <b>[[value]] "+n+"</b>"},useDataSetColors:!1}],stockLegend:{enabled:"undefined"==typeof s.legendEnabled||s.legendEnabled,color:s.color||"#383838",fontSize:s.fontSize||14,backgroundColor:s.backgroundColor||"#fff",backgroundAlpha:0,useGraphSettings:!0,equalWidths:!1,valueWidth:150,periodValueTextComparing:"[[percents.value.close]]%",periodValueTextRegular:"[[value.close]]",valueFunction:d},valueAxes:[{position:"right",color:s.color||"#383838",gridColor:s.gridColor||"#e0e0e0",gridAlpha:s.gridAlpha||.8,gridThickness:"undefined"!=typeof s.gridThickness?s.gridThickness:1}]},{title:s.secondaryPanelTitle||"Volume",percentHeight:30,precision:0,stockGraphs:[{valueField:"volume",type:s.secondaryChartType||"column",showBalloon:!0,lineColor:s.secondaryLineColor||"#00842c",fillAlphas:s.secondaryLineColorAlpha||.15,lineThickness:"undefined"!=typeof s.secondaryLineThickness?s.secondaryLineThickness:1,balloonText:"[[title]]: <b>[[value]]</b>",useDataSetColors:!1,comparable:!0,compareGraph:{type:s.secondaryChartType||"column",fillAlphas:s.secondaryLineColorAlpha||.15,lineThickness:"undefined"!=typeof s.secondaryLineThickness?s.secondaryLineThickness:1,balloonText:"[[title]]: <b>[[value]]</b>"}}],stockLegend:{color:s.color||"#383838",periodValueTextComparing:"[[percents.value.close]]%",periodValueTextRegular:"[[value.close]]"},valueAxes:[{position:"right",color:s.color||"#383838",gridColor:s.gridColor||"#e0e0e0",gridAlpha:s.gridAlpha||.8,gridThickness:"undefined"!=typeof s.gridThickness?s.gridThickness:1}]}],chartScrollbarSettings:{graph:"mainGraph",enabled:"undefined"==typeof s.scrollbarEnabled||s.scrollbarEnabled,color:s.color||"#383838",backgroundColor:s.scrollbarBackgroundColor||"#e8e8e8",backgroundAlpha:1,selectedBackgroundColor:s.scrollbarSelectedBackgroundColor||"#f7f7f7",selectedBackgroundAlpha:1,graphFillColor:s.scrollbarGraphFillColor||"#004c19",graphFillAlpha:1,selectedGraphFillColor:s.scrollbarSelectedGraphFillColor||"#00aa38",selectedGraphFillAlpha:1,gridColor:s.gridColor||"#e0e0e0",gridAlpha:s.gridAlpha||.8,gridThickness:"undefined"!=typeof s.gridThickness?s.gridThickness:1},chartCursorSettings:{enabled:"undefined"==typeof s.cursorEnabled||s.cursorEnabled,cursorColor:s.cursorColor||"#ba0000",cursorAlpha:s.cursorAlpha||.8,valueLineAlpha:s.cursorAlpha||.8,valueBalloonsEnabled:!0,graphBulletSize:1,valueLineBalloonEnabled:!0,valueLineEnabled:!0,categoryBalloonColor:s.cursorColor||"#ba0000",categoryBalloonAlpha:s.cursorAlpha||.8},periodSelector:{position:"top",periodsText:"",inputFieldsEnabled:!1,periods:[{period:"MM",count:1,label:"1M",selected:!0},{period:"MM",count:3,label:"3M"},{period:"MM",count:6,label:"6M"},{period:"YTD",label:"YTD"},{period:"YYYY",count:1,label:"1Y"},{period:"MAX",label:"All"}]},dataSetSelector:{position:""},comparedDataSets:[],"export":{enabled:"undefined"==typeof s.exportEnabled||s.exportEnabled,position:"top-right"},listeners:[{event:"init",method:function(){c&&y.find(".amcharts-stock-panel-div-stockPanel0 .amcharts-main-div").prepend('<div style="background: url('+cccGlobals.pluginUrl+c+") no-repeat center center; position: absolute; width: 100%; height: 100%; opacity: "+(void 0!==s.logoAlpha?s.logoAlpha:.18)+';"></div>')}}]};m=o.makeChart(a+"-chart",C),e.ajax({url:cccGlobals.ajaxUrl,method:"post",dataType:"json",data:{action:cccGlobals.ajaxGetData,asset:i,currency:n}}).done(function(e){r("response",e),e.success?(C.dataSets[0].title=e.symbol,C.dataSets[0].dataProvider=e.data,m.validateData(),setTimeout(function(){m.periodSelector.setDefaultPeriod()},100)):r("ERROR response received",e.data)}),v.on("change",function(){var o=e(this),a=o.val();if(a){var r=b.subtract(a),l=a.subtract(b);r.length&&u(r[0]),l.length&&p(l[0]),b=a}else{for(var t=0;t<b.length;t++)u(b[t]);b=[]}})}function r(){cccGlobals.debug&&console.log("CCC",arguments)}r("cccGlobals",cccGlobals);var l=cccGlobals.code,t=l+"-asset-autocomplete";return e.fn.cryptocurrencyChartsPlugin=function(){var o=this,a=e(this);return{initAssetAutocomplete:function(){return o.select2({allowClear:!!a.attr("multiple"),placeholder:"Symbol or coin name",containerCssClass:l+"-select2-container",dropdownCssClass:l+"-select2-dropdown",ajax:{url:cccGlobals.ajaxUrl,dataType:"json",delay:250,data:function(e){return{action:cccGlobals.ajaxSymbolAutocomplete,q:e.term}},processResults:function(e,o){return o.page=o.page||1,{results:e}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:function(e){return e.loading?e.text:'<div class="ccc-symbol-search-row"><img src="'+cccGlobals.pluginUrl+"/"+e.logo+'"><span class="ccc-symbol-search-name">'+e.text+'</span><span class="ccc-symbol-search-symbol">'+e.symbol+"</span></div>"},templateSelection:function(e){return e.symbol||e.id}})}}},Array.prototype.subtract=function(e){return e?this.filter(function(o){return e.indexOf(o)<0}):[]},{buildChart:a,log:r}}(jQuery,AmCharts);